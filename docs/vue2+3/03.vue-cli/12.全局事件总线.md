---
title: 全局事件总线
date: 2022-08-07 21:28:14
permalink: /8858e4/
---

## 全局事件总线（GlobalEventBus）

1. 一种组件间通信的方式，适用于<span style="color:red">任意组件间通信</span>。

2. 安装全局事件总线：

   ```js
   new Vue({
   	......
   	beforeCreate() {
   		Vue.prototype.$bus = this //安装全局事件总线，$bus 就是当前应用的 vm
   	},
       ......
   })
   ```

3. 使用事件总线：

   1. 接收数据：A 组件想接收数据，则在 A 组件中给\$bus 绑定自定义事件，事件的<span style="color:red">回调留在 A 组件自身。</span>

      ```js
      methods(){
        demo(data){......}
      }
      ......
      mounted() {
        this.$bus.$on('xxxx',this.demo)
      }
      ```

   2. 提供数据：`this.$bus.$emit('xxxx',数据)`

4. 最好在 beforeDestroy 钩子中，用\$off 去解绑<span style="color:red">当前组件所用到的</span>事件。

`VuePress` 无法 `new Vue`，故没办法安装全局事件总线，这里只贴一下代码吧

:::details 点击查看 School6 代码

<<< @/docs/.vuepress/components/School6.vue

:::

:::details 点击查看 Student6 代码

<<< @/docs/.vuepress/components/Student6.vue

:::

main.js

```js
//引入 Vue
import Vue from 'vue'
//引入 App
import App from './App.vue'
//关闭 Vue 的生产提示
Vue.config.productionTip = false

//创建 vm
new Vue({
  el: '#app',
  render: h => h(App),
  beforeCreate() {
    Vue.prototype.$bus = this //安装全局事件总线
  }
})
```
